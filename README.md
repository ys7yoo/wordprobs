# wordprobs

code from http://groups.csail.mit.edu/rbg/code/wordprobs/


# Info from README.txt

## BASIC RUNNING
To run the code on the dataset from the paper:
```
./run.sh Main <Test Fold #>
```
So to test on fold 0 run:
```
./run.sh Main 0
```

If your machine has less than ~30G of memory, then modify run-medium.sh to replace both instances of 25000 with the number of megs of memory you want to allocate to the java virtual machine

## PREPARING NEW DATA SETS
1.  Put your data into the same format as that in data/questions.json and replace that file with your own
  - note that all numbers must be in decimal format in all locations, the natural language of the question, the equations, and the numerical solutions
  - the numbers in the equations should exactly match those in the natural language (i.e. same number of significant digits, etc.)

2.  Generate the dependency parses for each question as follows:
 a. `./run.sh` Question  
   - make sure you only run this once
 b. `cd stanford-parser`
 c. `./runparserfull.sh`
 d. `mv questions*.xml parses`

3. Generate the fold files.  Each file is simply a list of questions indexes (the "iIndex" field in the questions.json file), with one index per line.  There is a separate file for each fold.


3.  Run the system as before:
```
./run.sh Main <Test Fold#>
```

## CONFIGURATION

The configuration is done in "data/config.json" with the following options:
* sFullQuestionFile - the question json file
* sStanfordParseDirectory - the directory for the dependency parses
* sFoldFilePrefix - the prefix for the fold files.  The full file names are generated by adding the fold number plus ".txt" to the prefix.
* iPercentageEquationAnnotations - the percentage of the data which has full equation annotations, for the rest of the training data the system will be given only the numerical answers.  Set this to 100 to run fully supervised.  The questions with full equation annotations will be chosen based on the order in the fold files (e.g. data/indexes-1-fold-0.txt), starting with all the questions in the first fold in the training set, and including questions in the later folds as necessary.
* iNumFold - the number of folds.  Be sure that if this is set to N then you have files with "<sFoldFilePrefix><Fold#>.txt" for each Fold# between 1 and N
* iNumThreads - the number of threads used
* iMaxBeamSize - the total number of entries allowed in the beam
* iMaxNumPerSystemInBeam - the number of entries allowed in the beam for each equation system template


## OUTPUT FORMAT

The important lines in the output are those starting with "TOTAL TEST STATS".
By default the system will run a full test on the test set for every training iteration.  It will also perform one final test run after the training converges.  This line will start with "FINAL TOTAL TEST STATS".  Each test stats line will contain the accuracy based on both metrics described the the paper, Answer Accurancy ("MargCorrNumerical"), and Equation Accuracy (MargCorrEquations).


